<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <title>Registro de Usuario</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/CSS/header.css">
</head>

<header>
  <div>
    <!-- Logo -->
    <a href="/">
      <img src="" alt="Logo">
    </a>

    <!-- Botón hamburguesa -->
    <button onclick="toggleMenu()">☰</button>

    <!-- Navegación -->
    <nav id="nav-menu" style="display: none;">
      <ul>
        <li><a href="/">Inicio</a></li>
        <li><a href="#">Publicar</a></li>
        <li><a href="login">Buscar</a></li>
        <li><a href="log">Login</a></li>
      </ul>
    </nav>

    <!-- Info de usuario -->
    <div id="usuario-info" onclick="toggleUserMenu()" style="display: none; cursor: pointer;">
      <img id="foto-usuario" src="" alt="Foto de perfil" width="40" height="40">
      <span id="nombre-usuario"></span>
    </div>

    <!-- Menú desplegable -->
    <div id="user-menu" style="display: none; border: 1px solid black; padding: 10px;">
      <div>
        <img id="foto-usuario-menu" src="" alt="Foto de perfil" width="60" height="60">
        <span id="nombre-usuario-menu"></span>
        <button onclick="redirigirPerfil()">Editar perfil</button>
        <button onclick="cerrarSesion()">Cerrar sesión</button>
      </div>
    </div>
  </div>
</header>

<script>
  function toggleMenu() {
    const menu = document.getElementById('nav-menu');
    menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
  }

  function toggleUserMenu() {
    const menu = document.getElementById('user-menu');
    menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
  }

  function redirigirPerfil() {
    const nombreUsuario = document.getElementById('nombre-usuario').textContent;
    window.location.href = `/perfils?usuario=${nombreUsuario}`;
  }

  function cerrarSesion() {
    localStorage.removeItem('usuario');
    window.location.reload();
  }

  document.addEventListener('DOMContentLoaded', () => {
    const usuario = JSON.parse(localStorage.getItem('usuario'));
    if (usuario) {
      document.getElementById('usuario-info').style.display = 'inline-block';
      document.getElementById('foto-usuario').src = `/Images/avatares/${usuario.foto_perfil}`;
      document.getElementById('foto-usuario-menu').src = `/Images/avatares/${usuario.foto_perfil}`;
      document.getElementById('nombre-usuario').textContent = usuario.nombre;
      document.getElementById('nombre-usuario-menu').textContent = usuario.nombre;
    }
  });
</script>



<body>
  <h1>Registro de Usuario</h1>
  <form action="/registro" method="POST" enctype="multipart/form-data">
    <label>Nombre:</label><br>
    <input type="text" name="nombre" required><br>

    <label>Apellido Paterno:</label><br>
    <input type="text" name="apellido_paterno" required><br>

    <label>Apellido Materno:</label><br>
    <input type="text" name="apellido_materno"><br>

    <label>Fecha de Nacimiento:</label><br>
    <input type="date" name="fecha_nacimiento" required><br>

    <label>Programa Educativo:</label><br>
    <input type="text" name="programa_educativo"><br>

    <label>Teléfono:</label><br>
    <input type="tel" name="telefono"><br>

    <label>Correo:</label><br>
    <input type="email" name="correo" required><br>

    <label>Género:</label><br>
    <select name="genero">
      <option value="">Selecciona...</option>
      <option value="Masculino">Masculino</option>
      <option value="Femenino">Femenino</option>
      <option value="Otro">Otro</option>
    </select><br>

    <label>Foto INE:</label><br>
    <input type="file" name="foto_ine" accept="image/*"><br>

    <label>Foto de Perfil:</label><br>
    <input type="file" name="foto_perfil" accept="image/*"><br>

    <label>Contraseña:</label><br>
    <input type="password" name="contrasena" required><br><br>

    <button type="submit">Registrarse</button>
  </form>
</body>

<script src="/JS/login.js"></script>
</html>